---
refcn: chapter_02/04_dns
refen: configuration/dns
---
# DNS

V2Ray دارای یک سرور DNS داخلی است که رله DNS را برای اجزای دیگر فراهم می کند.

{% hint style='info' %}

با توجه به پیچیدگی پروتکل DNS، V2Ray در حال حاضر تنها از درخواستهای IP اصلی (A و AAAA) پشتیبانی می کند. توصیه می کنیم از DNS حرفه ای (مانند [CoreDNS](https://coredns.io/)) برای V2Ray استفاده کنید.

{% endhint %}

پرسش های DNS که توسط این سرویس DNS رله می شود نیز براساس تنظیمات مسیریابی ارسال می شود. هیچ پیکربندی اضافی لازم نیست.

## DnsObject

`DnsObject` به عنوان `dns` فیلد در پیکربندی سطح بالا استفاده می شود.

```javascript
{
  "hosts": {
    "baidu.com": "127.0.0.1"
  },
  "servers": [
    {
      "address": "1.2.3.4",
      "port": 5353,
      "domains": [
        "domain:v2ray.com"
      ]
    },
    "8.8.8.8",
    "8.8.4.4",
    "localhost"
  ],
  "clientIp": "1.2.3.4"
}
```

> `hosts`: map{string: address}

لیستی از آدرس های IP ثابت. هر ورودی دارای نام دامنه به عنوان کلید و آدرس IP به عنوان ارزش است. اگر یک پرس و جو DNS یکی از دامنه های این لیست را هدف قرار دهد، IP مربوطه بلافاصله پس داده می شود و پرس و جو DNS نخواهد شد.

قالب دامنه:

* مانند `"v2ray.com"`: دامنه قابل حل باید برابر با این دامنه باشد.
* مانند `"domain: v2ray.com"`: دامنه قابل حل می تواند این دامنه یا هر زیر دامنه آن باشد.

> `سرور`: \ [رشته | [ServerObject](#serverobject) | "localhost" \]

فهرست سرورهای DNS. هر سرور ممکن است در سه فرمت مشخص شود: آدرس IP، [ServerObject](#serverobject)یا `"localhost"`.

هنگامی که یک سرور یک آدرس IP است، مانند `"8.8.8.8"`، V2Ray در DNS UDP روی 53 آدرس در این آدرس نمایش داده می شود.

هنگامی که یک سرور `"localhost"`، V2Ray میزبان محلی DNS را نمایش می دهد.

{% hint style='info' %}

هنگامی که `"localhost"` استفاده می شود، ترافیک در حال انجام DNS توسط V2Ray کنترل نمی شود. با این وجود، شما می توانید پرس و جوهای DNS را با تنظیمات اضافی به V2Ray هدایت کنید.

{% endhint %}

> `clientIp`: string

آدرس آی پی دستگاه فعلی. اگر مشخص شود، V2Ray از این IP به عنوان EDNS-Client-Subnet استفاده می کند. این IP نمی تواند یک آدرس خصوصی باشد.

### ServerObject

```javascript
{
  "address": "1.2.3.4",
  "port": 5353,
  "domains": [
    "domain:v2ray.com"
  ],
}
```

> `آدرس`: آدرس

آدرس سرور DNS در حال حاضر فقط سرورهای UDP پشتیبانی می شوند.

> `پورت`: شماره

پورت سرور DNS. معمولا `53` یا `5353`.

> `دامنه`: \ [رشته \]

لیستی از حوزه ها اگر دامنه پرس و جو با یکی از لیست مطابقت داشته باشد، این DNS سرور برای پرس و جو DNS برای این دامنه اولویت خواهد داشت.

فرمت نام دامنه همانند [مسیریابی](routing.md).

هنگامی که یک سرور DNS دارای دامنه در لیست دامنه خود است، دامنه در ابتدا در این سرور و سپس سرورهای دیگر مورد سوال قرار می گیرد. در غیر این صورت، پرس و جوهای DNS به سرورهای DNS ارسال می شوند به ترتیب آنها در فایل پیکربندی ظاهر می شوند.